// Code generated by ent, DO NOT EDIT.

package ent

import (
	"context"
	"encoding/json"
	"errors"
	"fmt"
	"time"

	"entgo.io/ent/dialect/sql"
	"entgo.io/ent/dialect/sql/sqlgraph"
	"entgo.io/ent/dialect/sql/sqljson"
	"entgo.io/ent/schema/field"
	"github.com/dannyota/hotpot/pkg/storage/ent/bronzes1threat"
	"github.com/dannyota/hotpot/pkg/storage/ent/internal"
	"github.com/dannyota/hotpot/pkg/storage/ent/predicate"
)

// BronzeS1ThreatUpdate is the builder for updating BronzeS1Threat entities.
type BronzeS1ThreatUpdate struct {
	config
	hooks    []Hook
	mutation *BronzeS1ThreatMutation
}

// Where appends a list predicates to the BronzeS1ThreatUpdate builder.
func (_u *BronzeS1ThreatUpdate) Where(ps ...predicate.BronzeS1Threat) *BronzeS1ThreatUpdate {
	_u.mutation.Where(ps...)
	return _u
}

// SetCollectedAt sets the "collected_at" field.
func (_u *BronzeS1ThreatUpdate) SetCollectedAt(v time.Time) *BronzeS1ThreatUpdate {
	_u.mutation.SetCollectedAt(v)
	return _u
}

// SetNillableCollectedAt sets the "collected_at" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableCollectedAt(v *time.Time) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetCollectedAt(*v)
	}
	return _u
}

// SetAgentID sets the "agent_id" field.
func (_u *BronzeS1ThreatUpdate) SetAgentID(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetAgentID(v)
	return _u
}

// SetNillableAgentID sets the "agent_id" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAgentID(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAgentID(*v)
	}
	return _u
}

// ClearAgentID clears the value of the "agent_id" field.
func (_u *BronzeS1ThreatUpdate) ClearAgentID() *BronzeS1ThreatUpdate {
	_u.mutation.ClearAgentID()
	return _u
}

// SetClassification sets the "classification" field.
func (_u *BronzeS1ThreatUpdate) SetClassification(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetClassification(v)
	return _u
}

// SetNillableClassification sets the "classification" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableClassification(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetClassification(*v)
	}
	return _u
}

// ClearClassification clears the value of the "classification" field.
func (_u *BronzeS1ThreatUpdate) ClearClassification() *BronzeS1ThreatUpdate {
	_u.mutation.ClearClassification()
	return _u
}

// SetThreatName sets the "threat_name" field.
func (_u *BronzeS1ThreatUpdate) SetThreatName(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetThreatName(v)
	return _u
}

// SetNillableThreatName sets the "threat_name" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableThreatName(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetThreatName(*v)
	}
	return _u
}

// ClearThreatName clears the value of the "threat_name" field.
func (_u *BronzeS1ThreatUpdate) ClearThreatName() *BronzeS1ThreatUpdate {
	_u.mutation.ClearThreatName()
	return _u
}

// SetFilePath sets the "file_path" field.
func (_u *BronzeS1ThreatUpdate) SetFilePath(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetFilePath(v)
	return _u
}

// SetNillableFilePath sets the "file_path" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableFilePath(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetFilePath(*v)
	}
	return _u
}

// ClearFilePath clears the value of the "file_path" field.
func (_u *BronzeS1ThreatUpdate) ClearFilePath() *BronzeS1ThreatUpdate {
	_u.mutation.ClearFilePath()
	return _u
}

// SetStatus sets the "status" field.
func (_u *BronzeS1ThreatUpdate) SetStatus(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetStatus(v)
	return _u
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableStatus(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetStatus(*v)
	}
	return _u
}

// ClearStatus clears the value of the "status" field.
func (_u *BronzeS1ThreatUpdate) ClearStatus() *BronzeS1ThreatUpdate {
	_u.mutation.ClearStatus()
	return _u
}

// SetAnalystVerdict sets the "analyst_verdict" field.
func (_u *BronzeS1ThreatUpdate) SetAnalystVerdict(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetAnalystVerdict(v)
	return _u
}

// SetNillableAnalystVerdict sets the "analyst_verdict" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAnalystVerdict(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAnalystVerdict(*v)
	}
	return _u
}

// ClearAnalystVerdict clears the value of the "analyst_verdict" field.
func (_u *BronzeS1ThreatUpdate) ClearAnalystVerdict() *BronzeS1ThreatUpdate {
	_u.mutation.ClearAnalystVerdict()
	return _u
}

// SetConfidenceLevel sets the "confidence_level" field.
func (_u *BronzeS1ThreatUpdate) SetConfidenceLevel(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetConfidenceLevel(v)
	return _u
}

// SetNillableConfidenceLevel sets the "confidence_level" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableConfidenceLevel(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetConfidenceLevel(*v)
	}
	return _u
}

// ClearConfidenceLevel clears the value of the "confidence_level" field.
func (_u *BronzeS1ThreatUpdate) ClearConfidenceLevel() *BronzeS1ThreatUpdate {
	_u.mutation.ClearConfidenceLevel()
	return _u
}

// SetInitiatedBy sets the "initiated_by" field.
func (_u *BronzeS1ThreatUpdate) SetInitiatedBy(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetInitiatedBy(v)
	return _u
}

// SetNillableInitiatedBy sets the "initiated_by" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableInitiatedBy(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetInitiatedBy(*v)
	}
	return _u
}

// ClearInitiatedBy clears the value of the "initiated_by" field.
func (_u *BronzeS1ThreatUpdate) ClearInitiatedBy() *BronzeS1ThreatUpdate {
	_u.mutation.ClearInitiatedBy()
	return _u
}

// SetAPICreatedAt sets the "api_created_at" field.
func (_u *BronzeS1ThreatUpdate) SetAPICreatedAt(v time.Time) *BronzeS1ThreatUpdate {
	_u.mutation.SetAPICreatedAt(v)
	return _u
}

// SetNillableAPICreatedAt sets the "api_created_at" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAPICreatedAt(v *time.Time) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAPICreatedAt(*v)
	}
	return _u
}

// ClearAPICreatedAt clears the value of the "api_created_at" field.
func (_u *BronzeS1ThreatUpdate) ClearAPICreatedAt() *BronzeS1ThreatUpdate {
	_u.mutation.ClearAPICreatedAt()
	return _u
}

// SetThreatInfoJSON sets the "threat_info_json" field.
func (_u *BronzeS1ThreatUpdate) SetThreatInfoJSON(v json.RawMessage) *BronzeS1ThreatUpdate {
	_u.mutation.SetThreatInfoJSON(v)
	return _u
}

// AppendThreatInfoJSON appends value to the "threat_info_json" field.
func (_u *BronzeS1ThreatUpdate) AppendThreatInfoJSON(v json.RawMessage) *BronzeS1ThreatUpdate {
	_u.mutation.AppendThreatInfoJSON(v)
	return _u
}

// ClearThreatInfoJSON clears the value of the "threat_info_json" field.
func (_u *BronzeS1ThreatUpdate) ClearThreatInfoJSON() *BronzeS1ThreatUpdate {
	_u.mutation.ClearThreatInfoJSON()
	return _u
}

// SetAPIUpdatedAt sets the "api_updated_at" field.
func (_u *BronzeS1ThreatUpdate) SetAPIUpdatedAt(v time.Time) *BronzeS1ThreatUpdate {
	_u.mutation.SetAPIUpdatedAt(v)
	return _u
}

// SetNillableAPIUpdatedAt sets the "api_updated_at" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAPIUpdatedAt(v *time.Time) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAPIUpdatedAt(*v)
	}
	return _u
}

// ClearAPIUpdatedAt clears the value of the "api_updated_at" field.
func (_u *BronzeS1ThreatUpdate) ClearAPIUpdatedAt() *BronzeS1ThreatUpdate {
	_u.mutation.ClearAPIUpdatedAt()
	return _u
}

// SetFileContentHash sets the "file_content_hash" field.
func (_u *BronzeS1ThreatUpdate) SetFileContentHash(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetFileContentHash(v)
	return _u
}

// SetNillableFileContentHash sets the "file_content_hash" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableFileContentHash(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetFileContentHash(*v)
	}
	return _u
}

// ClearFileContentHash clears the value of the "file_content_hash" field.
func (_u *BronzeS1ThreatUpdate) ClearFileContentHash() *BronzeS1ThreatUpdate {
	_u.mutation.ClearFileContentHash()
	return _u
}

// SetFileSha256 sets the "file_sha256" field.
func (_u *BronzeS1ThreatUpdate) SetFileSha256(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetFileSha256(v)
	return _u
}

// SetNillableFileSha256 sets the "file_sha256" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableFileSha256(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetFileSha256(*v)
	}
	return _u
}

// ClearFileSha256 clears the value of the "file_sha256" field.
func (_u *BronzeS1ThreatUpdate) ClearFileSha256() *BronzeS1ThreatUpdate {
	_u.mutation.ClearFileSha256()
	return _u
}

// SetCloudVerdict sets the "cloud_verdict" field.
func (_u *BronzeS1ThreatUpdate) SetCloudVerdict(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetCloudVerdict(v)
	return _u
}

// SetNillableCloudVerdict sets the "cloud_verdict" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableCloudVerdict(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetCloudVerdict(*v)
	}
	return _u
}

// ClearCloudVerdict clears the value of the "cloud_verdict" field.
func (_u *BronzeS1ThreatUpdate) ClearCloudVerdict() *BronzeS1ThreatUpdate {
	_u.mutation.ClearCloudVerdict()
	return _u
}

// SetClassificationSource sets the "classification_source" field.
func (_u *BronzeS1ThreatUpdate) SetClassificationSource(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetClassificationSource(v)
	return _u
}

// SetNillableClassificationSource sets the "classification_source" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableClassificationSource(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetClassificationSource(*v)
	}
	return _u
}

// ClearClassificationSource clears the value of the "classification_source" field.
func (_u *BronzeS1ThreatUpdate) ClearClassificationSource() *BronzeS1ThreatUpdate {
	_u.mutation.ClearClassificationSource()
	return _u
}

// SetSiteID sets the "site_id" field.
func (_u *BronzeS1ThreatUpdate) SetSiteID(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetSiteID(v)
	return _u
}

// SetNillableSiteID sets the "site_id" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableSiteID(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetSiteID(*v)
	}
	return _u
}

// ClearSiteID clears the value of the "site_id" field.
func (_u *BronzeS1ThreatUpdate) ClearSiteID() *BronzeS1ThreatUpdate {
	_u.mutation.ClearSiteID()
	return _u
}

// SetSiteName sets the "site_name" field.
func (_u *BronzeS1ThreatUpdate) SetSiteName(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetSiteName(v)
	return _u
}

// SetNillableSiteName sets the "site_name" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableSiteName(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetSiteName(*v)
	}
	return _u
}

// ClearSiteName clears the value of the "site_name" field.
func (_u *BronzeS1ThreatUpdate) ClearSiteName() *BronzeS1ThreatUpdate {
	_u.mutation.ClearSiteName()
	return _u
}

// SetAccountID sets the "account_id" field.
func (_u *BronzeS1ThreatUpdate) SetAccountID(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetAccountID(v)
	return _u
}

// SetNillableAccountID sets the "account_id" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAccountID(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAccountID(*v)
	}
	return _u
}

// ClearAccountID clears the value of the "account_id" field.
func (_u *BronzeS1ThreatUpdate) ClearAccountID() *BronzeS1ThreatUpdate {
	_u.mutation.ClearAccountID()
	return _u
}

// SetAccountName sets the "account_name" field.
func (_u *BronzeS1ThreatUpdate) SetAccountName(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetAccountName(v)
	return _u
}

// SetNillableAccountName sets the "account_name" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAccountName(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAccountName(*v)
	}
	return _u
}

// ClearAccountName clears the value of the "account_name" field.
func (_u *BronzeS1ThreatUpdate) ClearAccountName() *BronzeS1ThreatUpdate {
	_u.mutation.ClearAccountName()
	return _u
}

// SetAgentComputerName sets the "agent_computer_name" field.
func (_u *BronzeS1ThreatUpdate) SetAgentComputerName(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetAgentComputerName(v)
	return _u
}

// SetNillableAgentComputerName sets the "agent_computer_name" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAgentComputerName(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAgentComputerName(*v)
	}
	return _u
}

// ClearAgentComputerName clears the value of the "agent_computer_name" field.
func (_u *BronzeS1ThreatUpdate) ClearAgentComputerName() *BronzeS1ThreatUpdate {
	_u.mutation.ClearAgentComputerName()
	return _u
}

// SetAgentOsType sets the "agent_os_type" field.
func (_u *BronzeS1ThreatUpdate) SetAgentOsType(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetAgentOsType(v)
	return _u
}

// SetNillableAgentOsType sets the "agent_os_type" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAgentOsType(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAgentOsType(*v)
	}
	return _u
}

// ClearAgentOsType clears the value of the "agent_os_type" field.
func (_u *BronzeS1ThreatUpdate) ClearAgentOsType() *BronzeS1ThreatUpdate {
	_u.mutation.ClearAgentOsType()
	return _u
}

// SetAgentMachineType sets the "agent_machine_type" field.
func (_u *BronzeS1ThreatUpdate) SetAgentMachineType(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetAgentMachineType(v)
	return _u
}

// SetNillableAgentMachineType sets the "agent_machine_type" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAgentMachineType(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAgentMachineType(*v)
	}
	return _u
}

// ClearAgentMachineType clears the value of the "agent_machine_type" field.
func (_u *BronzeS1ThreatUpdate) ClearAgentMachineType() *BronzeS1ThreatUpdate {
	_u.mutation.ClearAgentMachineType()
	return _u
}

// SetAgentIsActive sets the "agent_is_active" field.
func (_u *BronzeS1ThreatUpdate) SetAgentIsActive(v bool) *BronzeS1ThreatUpdate {
	_u.mutation.SetAgentIsActive(v)
	return _u
}

// SetNillableAgentIsActive sets the "agent_is_active" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAgentIsActive(v *bool) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAgentIsActive(*v)
	}
	return _u
}

// SetAgentIsDecommissioned sets the "agent_is_decommissioned" field.
func (_u *BronzeS1ThreatUpdate) SetAgentIsDecommissioned(v bool) *BronzeS1ThreatUpdate {
	_u.mutation.SetAgentIsDecommissioned(v)
	return _u
}

// SetNillableAgentIsDecommissioned sets the "agent_is_decommissioned" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAgentIsDecommissioned(v *bool) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAgentIsDecommissioned(*v)
	}
	return _u
}

// SetAgentVersion sets the "agent_version" field.
func (_u *BronzeS1ThreatUpdate) SetAgentVersion(v string) *BronzeS1ThreatUpdate {
	_u.mutation.SetAgentVersion(v)
	return _u
}

// SetNillableAgentVersion sets the "agent_version" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdate) SetNillableAgentVersion(v *string) *BronzeS1ThreatUpdate {
	if v != nil {
		_u.SetAgentVersion(*v)
	}
	return _u
}

// ClearAgentVersion clears the value of the "agent_version" field.
func (_u *BronzeS1ThreatUpdate) ClearAgentVersion() *BronzeS1ThreatUpdate {
	_u.mutation.ClearAgentVersion()
	return _u
}

// Mutation returns the BronzeS1ThreatMutation object of the builder.
func (_u *BronzeS1ThreatUpdate) Mutation() *BronzeS1ThreatMutation {
	return _u.mutation
}

// Save executes the query and returns the number of nodes affected by the update operation.
func (_u *BronzeS1ThreatUpdate) Save(ctx context.Context) (int, error) {
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *BronzeS1ThreatUpdate) SaveX(ctx context.Context) int {
	affected, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return affected
}

// Exec executes the query.
func (_u *BronzeS1ThreatUpdate) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *BronzeS1ThreatUpdate) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

func (_u *BronzeS1ThreatUpdate) sqlSave(ctx context.Context) (_node int, err error) {
	_spec := sqlgraph.NewUpdateSpec(bronzes1threat.Table, bronzes1threat.Columns, sqlgraph.NewFieldSpec(bronzes1threat.FieldID, field.TypeString))
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := _u.mutation.CollectedAt(); ok {
		_spec.SetField(bronzes1threat.FieldCollectedAt, field.TypeTime, value)
	}
	if value, ok := _u.mutation.AgentID(); ok {
		_spec.SetField(bronzes1threat.FieldAgentID, field.TypeString, value)
	}
	if _u.mutation.AgentIDCleared() {
		_spec.ClearField(bronzes1threat.FieldAgentID, field.TypeString)
	}
	if value, ok := _u.mutation.Classification(); ok {
		_spec.SetField(bronzes1threat.FieldClassification, field.TypeString, value)
	}
	if _u.mutation.ClassificationCleared() {
		_spec.ClearField(bronzes1threat.FieldClassification, field.TypeString)
	}
	if value, ok := _u.mutation.ThreatName(); ok {
		_spec.SetField(bronzes1threat.FieldThreatName, field.TypeString, value)
	}
	if _u.mutation.ThreatNameCleared() {
		_spec.ClearField(bronzes1threat.FieldThreatName, field.TypeString)
	}
	if value, ok := _u.mutation.FilePath(); ok {
		_spec.SetField(bronzes1threat.FieldFilePath, field.TypeString, value)
	}
	if _u.mutation.FilePathCleared() {
		_spec.ClearField(bronzes1threat.FieldFilePath, field.TypeString)
	}
	if value, ok := _u.mutation.Status(); ok {
		_spec.SetField(bronzes1threat.FieldStatus, field.TypeString, value)
	}
	if _u.mutation.StatusCleared() {
		_spec.ClearField(bronzes1threat.FieldStatus, field.TypeString)
	}
	if value, ok := _u.mutation.AnalystVerdict(); ok {
		_spec.SetField(bronzes1threat.FieldAnalystVerdict, field.TypeString, value)
	}
	if _u.mutation.AnalystVerdictCleared() {
		_spec.ClearField(bronzes1threat.FieldAnalystVerdict, field.TypeString)
	}
	if value, ok := _u.mutation.ConfidenceLevel(); ok {
		_spec.SetField(bronzes1threat.FieldConfidenceLevel, field.TypeString, value)
	}
	if _u.mutation.ConfidenceLevelCleared() {
		_spec.ClearField(bronzes1threat.FieldConfidenceLevel, field.TypeString)
	}
	if value, ok := _u.mutation.InitiatedBy(); ok {
		_spec.SetField(bronzes1threat.FieldInitiatedBy, field.TypeString, value)
	}
	if _u.mutation.InitiatedByCleared() {
		_spec.ClearField(bronzes1threat.FieldInitiatedBy, field.TypeString)
	}
	if value, ok := _u.mutation.APICreatedAt(); ok {
		_spec.SetField(bronzes1threat.FieldAPICreatedAt, field.TypeTime, value)
	}
	if _u.mutation.APICreatedAtCleared() {
		_spec.ClearField(bronzes1threat.FieldAPICreatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.ThreatInfoJSON(); ok {
		_spec.SetField(bronzes1threat.FieldThreatInfoJSON, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedThreatInfoJSON(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, bronzes1threat.FieldThreatInfoJSON, value)
		})
	}
	if _u.mutation.ThreatInfoJSONCleared() {
		_spec.ClearField(bronzes1threat.FieldThreatInfoJSON, field.TypeJSON)
	}
	if value, ok := _u.mutation.APIUpdatedAt(); ok {
		_spec.SetField(bronzes1threat.FieldAPIUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.APIUpdatedAtCleared() {
		_spec.ClearField(bronzes1threat.FieldAPIUpdatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.FileContentHash(); ok {
		_spec.SetField(bronzes1threat.FieldFileContentHash, field.TypeString, value)
	}
	if _u.mutation.FileContentHashCleared() {
		_spec.ClearField(bronzes1threat.FieldFileContentHash, field.TypeString)
	}
	if value, ok := _u.mutation.FileSha256(); ok {
		_spec.SetField(bronzes1threat.FieldFileSha256, field.TypeString, value)
	}
	if _u.mutation.FileSha256Cleared() {
		_spec.ClearField(bronzes1threat.FieldFileSha256, field.TypeString)
	}
	if value, ok := _u.mutation.CloudVerdict(); ok {
		_spec.SetField(bronzes1threat.FieldCloudVerdict, field.TypeString, value)
	}
	if _u.mutation.CloudVerdictCleared() {
		_spec.ClearField(bronzes1threat.FieldCloudVerdict, field.TypeString)
	}
	if value, ok := _u.mutation.ClassificationSource(); ok {
		_spec.SetField(bronzes1threat.FieldClassificationSource, field.TypeString, value)
	}
	if _u.mutation.ClassificationSourceCleared() {
		_spec.ClearField(bronzes1threat.FieldClassificationSource, field.TypeString)
	}
	if value, ok := _u.mutation.SiteID(); ok {
		_spec.SetField(bronzes1threat.FieldSiteID, field.TypeString, value)
	}
	if _u.mutation.SiteIDCleared() {
		_spec.ClearField(bronzes1threat.FieldSiteID, field.TypeString)
	}
	if value, ok := _u.mutation.SiteName(); ok {
		_spec.SetField(bronzes1threat.FieldSiteName, field.TypeString, value)
	}
	if _u.mutation.SiteNameCleared() {
		_spec.ClearField(bronzes1threat.FieldSiteName, field.TypeString)
	}
	if value, ok := _u.mutation.AccountID(); ok {
		_spec.SetField(bronzes1threat.FieldAccountID, field.TypeString, value)
	}
	if _u.mutation.AccountIDCleared() {
		_spec.ClearField(bronzes1threat.FieldAccountID, field.TypeString)
	}
	if value, ok := _u.mutation.AccountName(); ok {
		_spec.SetField(bronzes1threat.FieldAccountName, field.TypeString, value)
	}
	if _u.mutation.AccountNameCleared() {
		_spec.ClearField(bronzes1threat.FieldAccountName, field.TypeString)
	}
	if value, ok := _u.mutation.AgentComputerName(); ok {
		_spec.SetField(bronzes1threat.FieldAgentComputerName, field.TypeString, value)
	}
	if _u.mutation.AgentComputerNameCleared() {
		_spec.ClearField(bronzes1threat.FieldAgentComputerName, field.TypeString)
	}
	if value, ok := _u.mutation.AgentOsType(); ok {
		_spec.SetField(bronzes1threat.FieldAgentOsType, field.TypeString, value)
	}
	if _u.mutation.AgentOsTypeCleared() {
		_spec.ClearField(bronzes1threat.FieldAgentOsType, field.TypeString)
	}
	if value, ok := _u.mutation.AgentMachineType(); ok {
		_spec.SetField(bronzes1threat.FieldAgentMachineType, field.TypeString, value)
	}
	if _u.mutation.AgentMachineTypeCleared() {
		_spec.ClearField(bronzes1threat.FieldAgentMachineType, field.TypeString)
	}
	if value, ok := _u.mutation.AgentIsActive(); ok {
		_spec.SetField(bronzes1threat.FieldAgentIsActive, field.TypeBool, value)
	}
	if value, ok := _u.mutation.AgentIsDecommissioned(); ok {
		_spec.SetField(bronzes1threat.FieldAgentIsDecommissioned, field.TypeBool, value)
	}
	if value, ok := _u.mutation.AgentVersion(); ok {
		_spec.SetField(bronzes1threat.FieldAgentVersion, field.TypeString, value)
	}
	if _u.mutation.AgentVersionCleared() {
		_spec.ClearField(bronzes1threat.FieldAgentVersion, field.TypeString)
	}
	_spec.Node.Schema = _u.schemaConfig.BronzeS1Threat
	ctx = internal.NewSchemaConfigContext(ctx, _u.schemaConfig)
	if _node, err = sqlgraph.UpdateNodes(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{bronzes1threat.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return 0, err
	}
	_u.mutation.done = true
	return _node, nil
}

// BronzeS1ThreatUpdateOne is the builder for updating a single BronzeS1Threat entity.
type BronzeS1ThreatUpdateOne struct {
	config
	fields   []string
	hooks    []Hook
	mutation *BronzeS1ThreatMutation
}

// SetCollectedAt sets the "collected_at" field.
func (_u *BronzeS1ThreatUpdateOne) SetCollectedAt(v time.Time) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetCollectedAt(v)
	return _u
}

// SetNillableCollectedAt sets the "collected_at" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableCollectedAt(v *time.Time) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetCollectedAt(*v)
	}
	return _u
}

// SetAgentID sets the "agent_id" field.
func (_u *BronzeS1ThreatUpdateOne) SetAgentID(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAgentID(v)
	return _u
}

// SetNillableAgentID sets the "agent_id" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAgentID(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentID(*v)
	}
	return _u
}

// ClearAgentID clears the value of the "agent_id" field.
func (_u *BronzeS1ThreatUpdateOne) ClearAgentID() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearAgentID()
	return _u
}

// SetClassification sets the "classification" field.
func (_u *BronzeS1ThreatUpdateOne) SetClassification(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetClassification(v)
	return _u
}

// SetNillableClassification sets the "classification" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableClassification(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetClassification(*v)
	}
	return _u
}

// ClearClassification clears the value of the "classification" field.
func (_u *BronzeS1ThreatUpdateOne) ClearClassification() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearClassification()
	return _u
}

// SetThreatName sets the "threat_name" field.
func (_u *BronzeS1ThreatUpdateOne) SetThreatName(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetThreatName(v)
	return _u
}

// SetNillableThreatName sets the "threat_name" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableThreatName(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetThreatName(*v)
	}
	return _u
}

// ClearThreatName clears the value of the "threat_name" field.
func (_u *BronzeS1ThreatUpdateOne) ClearThreatName() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearThreatName()
	return _u
}

// SetFilePath sets the "file_path" field.
func (_u *BronzeS1ThreatUpdateOne) SetFilePath(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetFilePath(v)
	return _u
}

// SetNillableFilePath sets the "file_path" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableFilePath(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetFilePath(*v)
	}
	return _u
}

// ClearFilePath clears the value of the "file_path" field.
func (_u *BronzeS1ThreatUpdateOne) ClearFilePath() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearFilePath()
	return _u
}

// SetStatus sets the "status" field.
func (_u *BronzeS1ThreatUpdateOne) SetStatus(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetStatus(v)
	return _u
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableStatus(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetStatus(*v)
	}
	return _u
}

// ClearStatus clears the value of the "status" field.
func (_u *BronzeS1ThreatUpdateOne) ClearStatus() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearStatus()
	return _u
}

// SetAnalystVerdict sets the "analyst_verdict" field.
func (_u *BronzeS1ThreatUpdateOne) SetAnalystVerdict(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAnalystVerdict(v)
	return _u
}

// SetNillableAnalystVerdict sets the "analyst_verdict" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAnalystVerdict(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAnalystVerdict(*v)
	}
	return _u
}

// ClearAnalystVerdict clears the value of the "analyst_verdict" field.
func (_u *BronzeS1ThreatUpdateOne) ClearAnalystVerdict() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearAnalystVerdict()
	return _u
}

// SetConfidenceLevel sets the "confidence_level" field.
func (_u *BronzeS1ThreatUpdateOne) SetConfidenceLevel(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetConfidenceLevel(v)
	return _u
}

// SetNillableConfidenceLevel sets the "confidence_level" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableConfidenceLevel(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetConfidenceLevel(*v)
	}
	return _u
}

// ClearConfidenceLevel clears the value of the "confidence_level" field.
func (_u *BronzeS1ThreatUpdateOne) ClearConfidenceLevel() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearConfidenceLevel()
	return _u
}

// SetInitiatedBy sets the "initiated_by" field.
func (_u *BronzeS1ThreatUpdateOne) SetInitiatedBy(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetInitiatedBy(v)
	return _u
}

// SetNillableInitiatedBy sets the "initiated_by" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableInitiatedBy(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetInitiatedBy(*v)
	}
	return _u
}

// ClearInitiatedBy clears the value of the "initiated_by" field.
func (_u *BronzeS1ThreatUpdateOne) ClearInitiatedBy() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearInitiatedBy()
	return _u
}

// SetAPICreatedAt sets the "api_created_at" field.
func (_u *BronzeS1ThreatUpdateOne) SetAPICreatedAt(v time.Time) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAPICreatedAt(v)
	return _u
}

// SetNillableAPICreatedAt sets the "api_created_at" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAPICreatedAt(v *time.Time) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAPICreatedAt(*v)
	}
	return _u
}

// ClearAPICreatedAt clears the value of the "api_created_at" field.
func (_u *BronzeS1ThreatUpdateOne) ClearAPICreatedAt() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearAPICreatedAt()
	return _u
}

// SetThreatInfoJSON sets the "threat_info_json" field.
func (_u *BronzeS1ThreatUpdateOne) SetThreatInfoJSON(v json.RawMessage) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetThreatInfoJSON(v)
	return _u
}

// AppendThreatInfoJSON appends value to the "threat_info_json" field.
func (_u *BronzeS1ThreatUpdateOne) AppendThreatInfoJSON(v json.RawMessage) *BronzeS1ThreatUpdateOne {
	_u.mutation.AppendThreatInfoJSON(v)
	return _u
}

// ClearThreatInfoJSON clears the value of the "threat_info_json" field.
func (_u *BronzeS1ThreatUpdateOne) ClearThreatInfoJSON() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearThreatInfoJSON()
	return _u
}

// SetAPIUpdatedAt sets the "api_updated_at" field.
func (_u *BronzeS1ThreatUpdateOne) SetAPIUpdatedAt(v time.Time) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAPIUpdatedAt(v)
	return _u
}

// SetNillableAPIUpdatedAt sets the "api_updated_at" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAPIUpdatedAt(v *time.Time) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAPIUpdatedAt(*v)
	}
	return _u
}

// ClearAPIUpdatedAt clears the value of the "api_updated_at" field.
func (_u *BronzeS1ThreatUpdateOne) ClearAPIUpdatedAt() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearAPIUpdatedAt()
	return _u
}

// SetFileContentHash sets the "file_content_hash" field.
func (_u *BronzeS1ThreatUpdateOne) SetFileContentHash(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetFileContentHash(v)
	return _u
}

// SetNillableFileContentHash sets the "file_content_hash" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableFileContentHash(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetFileContentHash(*v)
	}
	return _u
}

// ClearFileContentHash clears the value of the "file_content_hash" field.
func (_u *BronzeS1ThreatUpdateOne) ClearFileContentHash() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearFileContentHash()
	return _u
}

// SetFileSha256 sets the "file_sha256" field.
func (_u *BronzeS1ThreatUpdateOne) SetFileSha256(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetFileSha256(v)
	return _u
}

// SetNillableFileSha256 sets the "file_sha256" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableFileSha256(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetFileSha256(*v)
	}
	return _u
}

// ClearFileSha256 clears the value of the "file_sha256" field.
func (_u *BronzeS1ThreatUpdateOne) ClearFileSha256() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearFileSha256()
	return _u
}

// SetCloudVerdict sets the "cloud_verdict" field.
func (_u *BronzeS1ThreatUpdateOne) SetCloudVerdict(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetCloudVerdict(v)
	return _u
}

// SetNillableCloudVerdict sets the "cloud_verdict" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableCloudVerdict(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetCloudVerdict(*v)
	}
	return _u
}

// ClearCloudVerdict clears the value of the "cloud_verdict" field.
func (_u *BronzeS1ThreatUpdateOne) ClearCloudVerdict() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearCloudVerdict()
	return _u
}

// SetClassificationSource sets the "classification_source" field.
func (_u *BronzeS1ThreatUpdateOne) SetClassificationSource(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetClassificationSource(v)
	return _u
}

// SetNillableClassificationSource sets the "classification_source" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableClassificationSource(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetClassificationSource(*v)
	}
	return _u
}

// ClearClassificationSource clears the value of the "classification_source" field.
func (_u *BronzeS1ThreatUpdateOne) ClearClassificationSource() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearClassificationSource()
	return _u
}

// SetSiteID sets the "site_id" field.
func (_u *BronzeS1ThreatUpdateOne) SetSiteID(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetSiteID(v)
	return _u
}

// SetNillableSiteID sets the "site_id" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableSiteID(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetSiteID(*v)
	}
	return _u
}

// ClearSiteID clears the value of the "site_id" field.
func (_u *BronzeS1ThreatUpdateOne) ClearSiteID() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearSiteID()
	return _u
}

// SetSiteName sets the "site_name" field.
func (_u *BronzeS1ThreatUpdateOne) SetSiteName(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetSiteName(v)
	return _u
}

// SetNillableSiteName sets the "site_name" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableSiteName(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetSiteName(*v)
	}
	return _u
}

// ClearSiteName clears the value of the "site_name" field.
func (_u *BronzeS1ThreatUpdateOne) ClearSiteName() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearSiteName()
	return _u
}

// SetAccountID sets the "account_id" field.
func (_u *BronzeS1ThreatUpdateOne) SetAccountID(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAccountID(v)
	return _u
}

// SetNillableAccountID sets the "account_id" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAccountID(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAccountID(*v)
	}
	return _u
}

// ClearAccountID clears the value of the "account_id" field.
func (_u *BronzeS1ThreatUpdateOne) ClearAccountID() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearAccountID()
	return _u
}

// SetAccountName sets the "account_name" field.
func (_u *BronzeS1ThreatUpdateOne) SetAccountName(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAccountName(v)
	return _u
}

// SetNillableAccountName sets the "account_name" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAccountName(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAccountName(*v)
	}
	return _u
}

// ClearAccountName clears the value of the "account_name" field.
func (_u *BronzeS1ThreatUpdateOne) ClearAccountName() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearAccountName()
	return _u
}

// SetAgentComputerName sets the "agent_computer_name" field.
func (_u *BronzeS1ThreatUpdateOne) SetAgentComputerName(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAgentComputerName(v)
	return _u
}

// SetNillableAgentComputerName sets the "agent_computer_name" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAgentComputerName(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentComputerName(*v)
	}
	return _u
}

// ClearAgentComputerName clears the value of the "agent_computer_name" field.
func (_u *BronzeS1ThreatUpdateOne) ClearAgentComputerName() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearAgentComputerName()
	return _u
}

// SetAgentOsType sets the "agent_os_type" field.
func (_u *BronzeS1ThreatUpdateOne) SetAgentOsType(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAgentOsType(v)
	return _u
}

// SetNillableAgentOsType sets the "agent_os_type" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAgentOsType(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentOsType(*v)
	}
	return _u
}

// ClearAgentOsType clears the value of the "agent_os_type" field.
func (_u *BronzeS1ThreatUpdateOne) ClearAgentOsType() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearAgentOsType()
	return _u
}

// SetAgentMachineType sets the "agent_machine_type" field.
func (_u *BronzeS1ThreatUpdateOne) SetAgentMachineType(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAgentMachineType(v)
	return _u
}

// SetNillableAgentMachineType sets the "agent_machine_type" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAgentMachineType(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentMachineType(*v)
	}
	return _u
}

// ClearAgentMachineType clears the value of the "agent_machine_type" field.
func (_u *BronzeS1ThreatUpdateOne) ClearAgentMachineType() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearAgentMachineType()
	return _u
}

// SetAgentIsActive sets the "agent_is_active" field.
func (_u *BronzeS1ThreatUpdateOne) SetAgentIsActive(v bool) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAgentIsActive(v)
	return _u
}

// SetNillableAgentIsActive sets the "agent_is_active" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAgentIsActive(v *bool) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentIsActive(*v)
	}
	return _u
}

// SetAgentIsDecommissioned sets the "agent_is_decommissioned" field.
func (_u *BronzeS1ThreatUpdateOne) SetAgentIsDecommissioned(v bool) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAgentIsDecommissioned(v)
	return _u
}

// SetNillableAgentIsDecommissioned sets the "agent_is_decommissioned" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAgentIsDecommissioned(v *bool) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentIsDecommissioned(*v)
	}
	return _u
}

// SetAgentVersion sets the "agent_version" field.
func (_u *BronzeS1ThreatUpdateOne) SetAgentVersion(v string) *BronzeS1ThreatUpdateOne {
	_u.mutation.SetAgentVersion(v)
	return _u
}

// SetNillableAgentVersion sets the "agent_version" field if the given value is not nil.
func (_u *BronzeS1ThreatUpdateOne) SetNillableAgentVersion(v *string) *BronzeS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentVersion(*v)
	}
	return _u
}

// ClearAgentVersion clears the value of the "agent_version" field.
func (_u *BronzeS1ThreatUpdateOne) ClearAgentVersion() *BronzeS1ThreatUpdateOne {
	_u.mutation.ClearAgentVersion()
	return _u
}

// Mutation returns the BronzeS1ThreatMutation object of the builder.
func (_u *BronzeS1ThreatUpdateOne) Mutation() *BronzeS1ThreatMutation {
	return _u.mutation
}

// Where appends a list predicates to the BronzeS1ThreatUpdate builder.
func (_u *BronzeS1ThreatUpdateOne) Where(ps ...predicate.BronzeS1Threat) *BronzeS1ThreatUpdateOne {
	_u.mutation.Where(ps...)
	return _u
}

// Select allows selecting one or more fields (columns) of the returned entity.
// The default is selecting all fields defined in the entity schema.
func (_u *BronzeS1ThreatUpdateOne) Select(field string, fields ...string) *BronzeS1ThreatUpdateOne {
	_u.fields = append([]string{field}, fields...)
	return _u
}

// Save executes the query and returns the updated BronzeS1Threat entity.
func (_u *BronzeS1ThreatUpdateOne) Save(ctx context.Context) (*BronzeS1Threat, error) {
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *BronzeS1ThreatUpdateOne) SaveX(ctx context.Context) *BronzeS1Threat {
	node, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return node
}

// Exec executes the query on the entity.
func (_u *BronzeS1ThreatUpdateOne) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *BronzeS1ThreatUpdateOne) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

func (_u *BronzeS1ThreatUpdateOne) sqlSave(ctx context.Context) (_node *BronzeS1Threat, err error) {
	_spec := sqlgraph.NewUpdateSpec(bronzes1threat.Table, bronzes1threat.Columns, sqlgraph.NewFieldSpec(bronzes1threat.FieldID, field.TypeString))
	id, ok := _u.mutation.ID()
	if !ok {
		return nil, &ValidationError{Name: "id", err: errors.New(`ent: missing "BronzeS1Threat.id" for update`)}
	}
	_spec.Node.ID.Value = id
	if fields := _u.fields; len(fields) > 0 {
		_spec.Node.Columns = make([]string, 0, len(fields))
		_spec.Node.Columns = append(_spec.Node.Columns, bronzes1threat.FieldID)
		for _, f := range fields {
			if !bronzes1threat.ValidColumn(f) {
				return nil, &ValidationError{Name: f, err: fmt.Errorf("ent: invalid field %q for query", f)}
			}
			if f != bronzes1threat.FieldID {
				_spec.Node.Columns = append(_spec.Node.Columns, f)
			}
		}
	}
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := _u.mutation.CollectedAt(); ok {
		_spec.SetField(bronzes1threat.FieldCollectedAt, field.TypeTime, value)
	}
	if value, ok := _u.mutation.AgentID(); ok {
		_spec.SetField(bronzes1threat.FieldAgentID, field.TypeString, value)
	}
	if _u.mutation.AgentIDCleared() {
		_spec.ClearField(bronzes1threat.FieldAgentID, field.TypeString)
	}
	if value, ok := _u.mutation.Classification(); ok {
		_spec.SetField(bronzes1threat.FieldClassification, field.TypeString, value)
	}
	if _u.mutation.ClassificationCleared() {
		_spec.ClearField(bronzes1threat.FieldClassification, field.TypeString)
	}
	if value, ok := _u.mutation.ThreatName(); ok {
		_spec.SetField(bronzes1threat.FieldThreatName, field.TypeString, value)
	}
	if _u.mutation.ThreatNameCleared() {
		_spec.ClearField(bronzes1threat.FieldThreatName, field.TypeString)
	}
	if value, ok := _u.mutation.FilePath(); ok {
		_spec.SetField(bronzes1threat.FieldFilePath, field.TypeString, value)
	}
	if _u.mutation.FilePathCleared() {
		_spec.ClearField(bronzes1threat.FieldFilePath, field.TypeString)
	}
	if value, ok := _u.mutation.Status(); ok {
		_spec.SetField(bronzes1threat.FieldStatus, field.TypeString, value)
	}
	if _u.mutation.StatusCleared() {
		_spec.ClearField(bronzes1threat.FieldStatus, field.TypeString)
	}
	if value, ok := _u.mutation.AnalystVerdict(); ok {
		_spec.SetField(bronzes1threat.FieldAnalystVerdict, field.TypeString, value)
	}
	if _u.mutation.AnalystVerdictCleared() {
		_spec.ClearField(bronzes1threat.FieldAnalystVerdict, field.TypeString)
	}
	if value, ok := _u.mutation.ConfidenceLevel(); ok {
		_spec.SetField(bronzes1threat.FieldConfidenceLevel, field.TypeString, value)
	}
	if _u.mutation.ConfidenceLevelCleared() {
		_spec.ClearField(bronzes1threat.FieldConfidenceLevel, field.TypeString)
	}
	if value, ok := _u.mutation.InitiatedBy(); ok {
		_spec.SetField(bronzes1threat.FieldInitiatedBy, field.TypeString, value)
	}
	if _u.mutation.InitiatedByCleared() {
		_spec.ClearField(bronzes1threat.FieldInitiatedBy, field.TypeString)
	}
	if value, ok := _u.mutation.APICreatedAt(); ok {
		_spec.SetField(bronzes1threat.FieldAPICreatedAt, field.TypeTime, value)
	}
	if _u.mutation.APICreatedAtCleared() {
		_spec.ClearField(bronzes1threat.FieldAPICreatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.ThreatInfoJSON(); ok {
		_spec.SetField(bronzes1threat.FieldThreatInfoJSON, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedThreatInfoJSON(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, bronzes1threat.FieldThreatInfoJSON, value)
		})
	}
	if _u.mutation.ThreatInfoJSONCleared() {
		_spec.ClearField(bronzes1threat.FieldThreatInfoJSON, field.TypeJSON)
	}
	if value, ok := _u.mutation.APIUpdatedAt(); ok {
		_spec.SetField(bronzes1threat.FieldAPIUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.APIUpdatedAtCleared() {
		_spec.ClearField(bronzes1threat.FieldAPIUpdatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.FileContentHash(); ok {
		_spec.SetField(bronzes1threat.FieldFileContentHash, field.TypeString, value)
	}
	if _u.mutation.FileContentHashCleared() {
		_spec.ClearField(bronzes1threat.FieldFileContentHash, field.TypeString)
	}
	if value, ok := _u.mutation.FileSha256(); ok {
		_spec.SetField(bronzes1threat.FieldFileSha256, field.TypeString, value)
	}
	if _u.mutation.FileSha256Cleared() {
		_spec.ClearField(bronzes1threat.FieldFileSha256, field.TypeString)
	}
	if value, ok := _u.mutation.CloudVerdict(); ok {
		_spec.SetField(bronzes1threat.FieldCloudVerdict, field.TypeString, value)
	}
	if _u.mutation.CloudVerdictCleared() {
		_spec.ClearField(bronzes1threat.FieldCloudVerdict, field.TypeString)
	}
	if value, ok := _u.mutation.ClassificationSource(); ok {
		_spec.SetField(bronzes1threat.FieldClassificationSource, field.TypeString, value)
	}
	if _u.mutation.ClassificationSourceCleared() {
		_spec.ClearField(bronzes1threat.FieldClassificationSource, field.TypeString)
	}
	if value, ok := _u.mutation.SiteID(); ok {
		_spec.SetField(bronzes1threat.FieldSiteID, field.TypeString, value)
	}
	if _u.mutation.SiteIDCleared() {
		_spec.ClearField(bronzes1threat.FieldSiteID, field.TypeString)
	}
	if value, ok := _u.mutation.SiteName(); ok {
		_spec.SetField(bronzes1threat.FieldSiteName, field.TypeString, value)
	}
	if _u.mutation.SiteNameCleared() {
		_spec.ClearField(bronzes1threat.FieldSiteName, field.TypeString)
	}
	if value, ok := _u.mutation.AccountID(); ok {
		_spec.SetField(bronzes1threat.FieldAccountID, field.TypeString, value)
	}
	if _u.mutation.AccountIDCleared() {
		_spec.ClearField(bronzes1threat.FieldAccountID, field.TypeString)
	}
	if value, ok := _u.mutation.AccountName(); ok {
		_spec.SetField(bronzes1threat.FieldAccountName, field.TypeString, value)
	}
	if _u.mutation.AccountNameCleared() {
		_spec.ClearField(bronzes1threat.FieldAccountName, field.TypeString)
	}
	if value, ok := _u.mutation.AgentComputerName(); ok {
		_spec.SetField(bronzes1threat.FieldAgentComputerName, field.TypeString, value)
	}
	if _u.mutation.AgentComputerNameCleared() {
		_spec.ClearField(bronzes1threat.FieldAgentComputerName, field.TypeString)
	}
	if value, ok := _u.mutation.AgentOsType(); ok {
		_spec.SetField(bronzes1threat.FieldAgentOsType, field.TypeString, value)
	}
	if _u.mutation.AgentOsTypeCleared() {
		_spec.ClearField(bronzes1threat.FieldAgentOsType, field.TypeString)
	}
	if value, ok := _u.mutation.AgentMachineType(); ok {
		_spec.SetField(bronzes1threat.FieldAgentMachineType, field.TypeString, value)
	}
	if _u.mutation.AgentMachineTypeCleared() {
		_spec.ClearField(bronzes1threat.FieldAgentMachineType, field.TypeString)
	}
	if value, ok := _u.mutation.AgentIsActive(); ok {
		_spec.SetField(bronzes1threat.FieldAgentIsActive, field.TypeBool, value)
	}
	if value, ok := _u.mutation.AgentIsDecommissioned(); ok {
		_spec.SetField(bronzes1threat.FieldAgentIsDecommissioned, field.TypeBool, value)
	}
	if value, ok := _u.mutation.AgentVersion(); ok {
		_spec.SetField(bronzes1threat.FieldAgentVersion, field.TypeString, value)
	}
	if _u.mutation.AgentVersionCleared() {
		_spec.ClearField(bronzes1threat.FieldAgentVersion, field.TypeString)
	}
	_spec.Node.Schema = _u.schemaConfig.BronzeS1Threat
	ctx = internal.NewSchemaConfigContext(ctx, _u.schemaConfig)
	_node = &BronzeS1Threat{config: _u.config}
	_spec.Assign = _node.assignValues
	_spec.ScanValues = _node.scanValues
	if err = sqlgraph.UpdateNode(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{bronzes1threat.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return nil, err
	}
	_u.mutation.done = true
	return _node, nil
}
