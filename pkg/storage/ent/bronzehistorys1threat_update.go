// Code generated by ent, DO NOT EDIT.

package ent

import (
	"context"
	"encoding/json"
	"errors"
	"fmt"
	"time"

	"entgo.io/ent/dialect/sql"
	"entgo.io/ent/dialect/sql/sqlgraph"
	"entgo.io/ent/dialect/sql/sqljson"
	"entgo.io/ent/schema/field"
	"github.com/dannyota/hotpot/pkg/storage/ent/bronzehistorys1threat"
	"github.com/dannyota/hotpot/pkg/storage/ent/internal"
	"github.com/dannyota/hotpot/pkg/storage/ent/predicate"
)

// BronzeHistoryS1ThreatUpdate is the builder for updating BronzeHistoryS1Threat entities.
type BronzeHistoryS1ThreatUpdate struct {
	config
	hooks    []Hook
	mutation *BronzeHistoryS1ThreatMutation
}

// Where appends a list predicates to the BronzeHistoryS1ThreatUpdate builder.
func (_u *BronzeHistoryS1ThreatUpdate) Where(ps ...predicate.BronzeHistoryS1Threat) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.Where(ps...)
	return _u
}

// SetValidTo sets the "valid_to" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetValidTo(v time.Time) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetValidTo(v)
	return _u
}

// SetNillableValidTo sets the "valid_to" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableValidTo(v *time.Time) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetValidTo(*v)
	}
	return _u
}

// ClearValidTo clears the value of the "valid_to" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearValidTo() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearValidTo()
	return _u
}

// SetCollectedAt sets the "collected_at" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetCollectedAt(v time.Time) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetCollectedAt(v)
	return _u
}

// SetNillableCollectedAt sets the "collected_at" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableCollectedAt(v *time.Time) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetCollectedAt(*v)
	}
	return _u
}

// SetFirstCollectedAt sets the "first_collected_at" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetFirstCollectedAt(v time.Time) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetFirstCollectedAt(v)
	return _u
}

// SetNillableFirstCollectedAt sets the "first_collected_at" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableFirstCollectedAt(v *time.Time) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetFirstCollectedAt(*v)
	}
	return _u
}

// SetResourceID sets the "resource_id" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetResourceID(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetResourceID(v)
	return _u
}

// SetNillableResourceID sets the "resource_id" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableResourceID(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetResourceID(*v)
	}
	return _u
}

// SetAgentID sets the "agent_id" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAgentID(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAgentID(v)
	return _u
}

// SetNillableAgentID sets the "agent_id" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAgentID(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAgentID(*v)
	}
	return _u
}

// ClearAgentID clears the value of the "agent_id" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearAgentID() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearAgentID()
	return _u
}

// SetClassification sets the "classification" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetClassification(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetClassification(v)
	return _u
}

// SetNillableClassification sets the "classification" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableClassification(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetClassification(*v)
	}
	return _u
}

// ClearClassification clears the value of the "classification" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearClassification() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearClassification()
	return _u
}

// SetThreatName sets the "threat_name" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetThreatName(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetThreatName(v)
	return _u
}

// SetNillableThreatName sets the "threat_name" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableThreatName(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetThreatName(*v)
	}
	return _u
}

// ClearThreatName clears the value of the "threat_name" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearThreatName() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearThreatName()
	return _u
}

// SetFilePath sets the "file_path" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetFilePath(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetFilePath(v)
	return _u
}

// SetNillableFilePath sets the "file_path" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableFilePath(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetFilePath(*v)
	}
	return _u
}

// ClearFilePath clears the value of the "file_path" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearFilePath() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearFilePath()
	return _u
}

// SetStatus sets the "status" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetStatus(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetStatus(v)
	return _u
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableStatus(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetStatus(*v)
	}
	return _u
}

// ClearStatus clears the value of the "status" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearStatus() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearStatus()
	return _u
}

// SetAnalystVerdict sets the "analyst_verdict" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAnalystVerdict(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAnalystVerdict(v)
	return _u
}

// SetNillableAnalystVerdict sets the "analyst_verdict" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAnalystVerdict(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAnalystVerdict(*v)
	}
	return _u
}

// ClearAnalystVerdict clears the value of the "analyst_verdict" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearAnalystVerdict() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearAnalystVerdict()
	return _u
}

// SetConfidenceLevel sets the "confidence_level" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetConfidenceLevel(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetConfidenceLevel(v)
	return _u
}

// SetNillableConfidenceLevel sets the "confidence_level" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableConfidenceLevel(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetConfidenceLevel(*v)
	}
	return _u
}

// ClearConfidenceLevel clears the value of the "confidence_level" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearConfidenceLevel() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearConfidenceLevel()
	return _u
}

// SetInitiatedBy sets the "initiated_by" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetInitiatedBy(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetInitiatedBy(v)
	return _u
}

// SetNillableInitiatedBy sets the "initiated_by" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableInitiatedBy(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetInitiatedBy(*v)
	}
	return _u
}

// ClearInitiatedBy clears the value of the "initiated_by" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearInitiatedBy() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearInitiatedBy()
	return _u
}

// SetAPICreatedAt sets the "api_created_at" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAPICreatedAt(v time.Time) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAPICreatedAt(v)
	return _u
}

// SetNillableAPICreatedAt sets the "api_created_at" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAPICreatedAt(v *time.Time) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAPICreatedAt(*v)
	}
	return _u
}

// ClearAPICreatedAt clears the value of the "api_created_at" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearAPICreatedAt() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearAPICreatedAt()
	return _u
}

// SetThreatInfoJSON sets the "threat_info_json" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetThreatInfoJSON(v json.RawMessage) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetThreatInfoJSON(v)
	return _u
}

// AppendThreatInfoJSON appends value to the "threat_info_json" field.
func (_u *BronzeHistoryS1ThreatUpdate) AppendThreatInfoJSON(v json.RawMessage) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.AppendThreatInfoJSON(v)
	return _u
}

// ClearThreatInfoJSON clears the value of the "threat_info_json" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearThreatInfoJSON() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearThreatInfoJSON()
	return _u
}

// SetAPIUpdatedAt sets the "api_updated_at" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAPIUpdatedAt(v time.Time) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAPIUpdatedAt(v)
	return _u
}

// SetNillableAPIUpdatedAt sets the "api_updated_at" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAPIUpdatedAt(v *time.Time) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAPIUpdatedAt(*v)
	}
	return _u
}

// ClearAPIUpdatedAt clears the value of the "api_updated_at" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearAPIUpdatedAt() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearAPIUpdatedAt()
	return _u
}

// SetFileContentHash sets the "file_content_hash" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetFileContentHash(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetFileContentHash(v)
	return _u
}

// SetNillableFileContentHash sets the "file_content_hash" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableFileContentHash(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetFileContentHash(*v)
	}
	return _u
}

// ClearFileContentHash clears the value of the "file_content_hash" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearFileContentHash() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearFileContentHash()
	return _u
}

// SetFileSha256 sets the "file_sha256" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetFileSha256(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetFileSha256(v)
	return _u
}

// SetNillableFileSha256 sets the "file_sha256" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableFileSha256(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetFileSha256(*v)
	}
	return _u
}

// ClearFileSha256 clears the value of the "file_sha256" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearFileSha256() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearFileSha256()
	return _u
}

// SetCloudVerdict sets the "cloud_verdict" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetCloudVerdict(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetCloudVerdict(v)
	return _u
}

// SetNillableCloudVerdict sets the "cloud_verdict" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableCloudVerdict(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetCloudVerdict(*v)
	}
	return _u
}

// ClearCloudVerdict clears the value of the "cloud_verdict" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearCloudVerdict() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearCloudVerdict()
	return _u
}

// SetClassificationSource sets the "classification_source" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetClassificationSource(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetClassificationSource(v)
	return _u
}

// SetNillableClassificationSource sets the "classification_source" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableClassificationSource(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetClassificationSource(*v)
	}
	return _u
}

// ClearClassificationSource clears the value of the "classification_source" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearClassificationSource() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearClassificationSource()
	return _u
}

// SetSiteID sets the "site_id" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetSiteID(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetSiteID(v)
	return _u
}

// SetNillableSiteID sets the "site_id" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableSiteID(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetSiteID(*v)
	}
	return _u
}

// ClearSiteID clears the value of the "site_id" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearSiteID() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearSiteID()
	return _u
}

// SetSiteName sets the "site_name" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetSiteName(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetSiteName(v)
	return _u
}

// SetNillableSiteName sets the "site_name" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableSiteName(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetSiteName(*v)
	}
	return _u
}

// ClearSiteName clears the value of the "site_name" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearSiteName() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearSiteName()
	return _u
}

// SetAccountID sets the "account_id" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAccountID(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAccountID(v)
	return _u
}

// SetNillableAccountID sets the "account_id" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAccountID(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAccountID(*v)
	}
	return _u
}

// ClearAccountID clears the value of the "account_id" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearAccountID() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearAccountID()
	return _u
}

// SetAccountName sets the "account_name" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAccountName(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAccountName(v)
	return _u
}

// SetNillableAccountName sets the "account_name" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAccountName(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAccountName(*v)
	}
	return _u
}

// ClearAccountName clears the value of the "account_name" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearAccountName() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearAccountName()
	return _u
}

// SetAgentComputerName sets the "agent_computer_name" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAgentComputerName(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAgentComputerName(v)
	return _u
}

// SetNillableAgentComputerName sets the "agent_computer_name" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAgentComputerName(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAgentComputerName(*v)
	}
	return _u
}

// ClearAgentComputerName clears the value of the "agent_computer_name" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearAgentComputerName() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearAgentComputerName()
	return _u
}

// SetAgentOsType sets the "agent_os_type" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAgentOsType(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAgentOsType(v)
	return _u
}

// SetNillableAgentOsType sets the "agent_os_type" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAgentOsType(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAgentOsType(*v)
	}
	return _u
}

// ClearAgentOsType clears the value of the "agent_os_type" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearAgentOsType() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearAgentOsType()
	return _u
}

// SetAgentMachineType sets the "agent_machine_type" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAgentMachineType(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAgentMachineType(v)
	return _u
}

// SetNillableAgentMachineType sets the "agent_machine_type" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAgentMachineType(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAgentMachineType(*v)
	}
	return _u
}

// ClearAgentMachineType clears the value of the "agent_machine_type" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearAgentMachineType() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearAgentMachineType()
	return _u
}

// SetAgentIsActive sets the "agent_is_active" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAgentIsActive(v bool) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAgentIsActive(v)
	return _u
}

// SetNillableAgentIsActive sets the "agent_is_active" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAgentIsActive(v *bool) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAgentIsActive(*v)
	}
	return _u
}

// SetAgentIsDecommissioned sets the "agent_is_decommissioned" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAgentIsDecommissioned(v bool) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAgentIsDecommissioned(v)
	return _u
}

// SetNillableAgentIsDecommissioned sets the "agent_is_decommissioned" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAgentIsDecommissioned(v *bool) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAgentIsDecommissioned(*v)
	}
	return _u
}

// SetAgentVersion sets the "agent_version" field.
func (_u *BronzeHistoryS1ThreatUpdate) SetAgentVersion(v string) *BronzeHistoryS1ThreatUpdate {
	_u.mutation.SetAgentVersion(v)
	return _u
}

// SetNillableAgentVersion sets the "agent_version" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdate) SetNillableAgentVersion(v *string) *BronzeHistoryS1ThreatUpdate {
	if v != nil {
		_u.SetAgentVersion(*v)
	}
	return _u
}

// ClearAgentVersion clears the value of the "agent_version" field.
func (_u *BronzeHistoryS1ThreatUpdate) ClearAgentVersion() *BronzeHistoryS1ThreatUpdate {
	_u.mutation.ClearAgentVersion()
	return _u
}

// Mutation returns the BronzeHistoryS1ThreatMutation object of the builder.
func (_u *BronzeHistoryS1ThreatUpdate) Mutation() *BronzeHistoryS1ThreatMutation {
	return _u.mutation
}

// Save executes the query and returns the number of nodes affected by the update operation.
func (_u *BronzeHistoryS1ThreatUpdate) Save(ctx context.Context) (int, error) {
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *BronzeHistoryS1ThreatUpdate) SaveX(ctx context.Context) int {
	affected, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return affected
}

// Exec executes the query.
func (_u *BronzeHistoryS1ThreatUpdate) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *BronzeHistoryS1ThreatUpdate) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

// check runs all checks and user-defined validators on the builder.
func (_u *BronzeHistoryS1ThreatUpdate) check() error {
	if v, ok := _u.mutation.ResourceID(); ok {
		if err := bronzehistorys1threat.ResourceIDValidator(v); err != nil {
			return &ValidationError{Name: "resource_id", err: fmt.Errorf(`ent: validator failed for field "BronzeHistoryS1Threat.resource_id": %w`, err)}
		}
	}
	return nil
}

func (_u *BronzeHistoryS1ThreatUpdate) sqlSave(ctx context.Context) (_node int, err error) {
	if err := _u.check(); err != nil {
		return _node, err
	}
	_spec := sqlgraph.NewUpdateSpec(bronzehistorys1threat.Table, bronzehistorys1threat.Columns, sqlgraph.NewFieldSpec(bronzehistorys1threat.FieldID, field.TypeInt))
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := _u.mutation.ValidTo(); ok {
		_spec.SetField(bronzehistorys1threat.FieldValidTo, field.TypeTime, value)
	}
	if _u.mutation.ValidToCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldValidTo, field.TypeTime)
	}
	if value, ok := _u.mutation.CollectedAt(); ok {
		_spec.SetField(bronzehistorys1threat.FieldCollectedAt, field.TypeTime, value)
	}
	if value, ok := _u.mutation.FirstCollectedAt(); ok {
		_spec.SetField(bronzehistorys1threat.FieldFirstCollectedAt, field.TypeTime, value)
	}
	if value, ok := _u.mutation.ResourceID(); ok {
		_spec.SetField(bronzehistorys1threat.FieldResourceID, field.TypeString, value)
	}
	if value, ok := _u.mutation.AgentID(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentID, field.TypeString, value)
	}
	if _u.mutation.AgentIDCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAgentID, field.TypeString)
	}
	if value, ok := _u.mutation.Classification(); ok {
		_spec.SetField(bronzehistorys1threat.FieldClassification, field.TypeString, value)
	}
	if _u.mutation.ClassificationCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldClassification, field.TypeString)
	}
	if value, ok := _u.mutation.ThreatName(); ok {
		_spec.SetField(bronzehistorys1threat.FieldThreatName, field.TypeString, value)
	}
	if _u.mutation.ThreatNameCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldThreatName, field.TypeString)
	}
	if value, ok := _u.mutation.FilePath(); ok {
		_spec.SetField(bronzehistorys1threat.FieldFilePath, field.TypeString, value)
	}
	if _u.mutation.FilePathCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldFilePath, field.TypeString)
	}
	if value, ok := _u.mutation.Status(); ok {
		_spec.SetField(bronzehistorys1threat.FieldStatus, field.TypeString, value)
	}
	if _u.mutation.StatusCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldStatus, field.TypeString)
	}
	if value, ok := _u.mutation.AnalystVerdict(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAnalystVerdict, field.TypeString, value)
	}
	if _u.mutation.AnalystVerdictCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAnalystVerdict, field.TypeString)
	}
	if value, ok := _u.mutation.ConfidenceLevel(); ok {
		_spec.SetField(bronzehistorys1threat.FieldConfidenceLevel, field.TypeString, value)
	}
	if _u.mutation.ConfidenceLevelCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldConfidenceLevel, field.TypeString)
	}
	if value, ok := _u.mutation.InitiatedBy(); ok {
		_spec.SetField(bronzehistorys1threat.FieldInitiatedBy, field.TypeString, value)
	}
	if _u.mutation.InitiatedByCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldInitiatedBy, field.TypeString)
	}
	if value, ok := _u.mutation.APICreatedAt(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAPICreatedAt, field.TypeTime, value)
	}
	if _u.mutation.APICreatedAtCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAPICreatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.ThreatInfoJSON(); ok {
		_spec.SetField(bronzehistorys1threat.FieldThreatInfoJSON, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedThreatInfoJSON(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, bronzehistorys1threat.FieldThreatInfoJSON, value)
		})
	}
	if _u.mutation.ThreatInfoJSONCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldThreatInfoJSON, field.TypeJSON)
	}
	if value, ok := _u.mutation.APIUpdatedAt(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAPIUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.APIUpdatedAtCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAPIUpdatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.FileContentHash(); ok {
		_spec.SetField(bronzehistorys1threat.FieldFileContentHash, field.TypeString, value)
	}
	if _u.mutation.FileContentHashCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldFileContentHash, field.TypeString)
	}
	if value, ok := _u.mutation.FileSha256(); ok {
		_spec.SetField(bronzehistorys1threat.FieldFileSha256, field.TypeString, value)
	}
	if _u.mutation.FileSha256Cleared() {
		_spec.ClearField(bronzehistorys1threat.FieldFileSha256, field.TypeString)
	}
	if value, ok := _u.mutation.CloudVerdict(); ok {
		_spec.SetField(bronzehistorys1threat.FieldCloudVerdict, field.TypeString, value)
	}
	if _u.mutation.CloudVerdictCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldCloudVerdict, field.TypeString)
	}
	if value, ok := _u.mutation.ClassificationSource(); ok {
		_spec.SetField(bronzehistorys1threat.FieldClassificationSource, field.TypeString, value)
	}
	if _u.mutation.ClassificationSourceCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldClassificationSource, field.TypeString)
	}
	if value, ok := _u.mutation.SiteID(); ok {
		_spec.SetField(bronzehistorys1threat.FieldSiteID, field.TypeString, value)
	}
	if _u.mutation.SiteIDCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldSiteID, field.TypeString)
	}
	if value, ok := _u.mutation.SiteName(); ok {
		_spec.SetField(bronzehistorys1threat.FieldSiteName, field.TypeString, value)
	}
	if _u.mutation.SiteNameCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldSiteName, field.TypeString)
	}
	if value, ok := _u.mutation.AccountID(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAccountID, field.TypeString, value)
	}
	if _u.mutation.AccountIDCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAccountID, field.TypeString)
	}
	if value, ok := _u.mutation.AccountName(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAccountName, field.TypeString, value)
	}
	if _u.mutation.AccountNameCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAccountName, field.TypeString)
	}
	if value, ok := _u.mutation.AgentComputerName(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentComputerName, field.TypeString, value)
	}
	if _u.mutation.AgentComputerNameCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAgentComputerName, field.TypeString)
	}
	if value, ok := _u.mutation.AgentOsType(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentOsType, field.TypeString, value)
	}
	if _u.mutation.AgentOsTypeCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAgentOsType, field.TypeString)
	}
	if value, ok := _u.mutation.AgentMachineType(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentMachineType, field.TypeString, value)
	}
	if _u.mutation.AgentMachineTypeCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAgentMachineType, field.TypeString)
	}
	if value, ok := _u.mutation.AgentIsActive(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentIsActive, field.TypeBool, value)
	}
	if value, ok := _u.mutation.AgentIsDecommissioned(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentIsDecommissioned, field.TypeBool, value)
	}
	if value, ok := _u.mutation.AgentVersion(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentVersion, field.TypeString, value)
	}
	if _u.mutation.AgentVersionCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAgentVersion, field.TypeString)
	}
	_spec.Node.Schema = _u.schemaConfig.BronzeHistoryS1Threat
	ctx = internal.NewSchemaConfigContext(ctx, _u.schemaConfig)
	if _node, err = sqlgraph.UpdateNodes(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{bronzehistorys1threat.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return 0, err
	}
	_u.mutation.done = true
	return _node, nil
}

// BronzeHistoryS1ThreatUpdateOne is the builder for updating a single BronzeHistoryS1Threat entity.
type BronzeHistoryS1ThreatUpdateOne struct {
	config
	fields   []string
	hooks    []Hook
	mutation *BronzeHistoryS1ThreatMutation
}

// SetValidTo sets the "valid_to" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetValidTo(v time.Time) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetValidTo(v)
	return _u
}

// SetNillableValidTo sets the "valid_to" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableValidTo(v *time.Time) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetValidTo(*v)
	}
	return _u
}

// ClearValidTo clears the value of the "valid_to" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearValidTo() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearValidTo()
	return _u
}

// SetCollectedAt sets the "collected_at" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetCollectedAt(v time.Time) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetCollectedAt(v)
	return _u
}

// SetNillableCollectedAt sets the "collected_at" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableCollectedAt(v *time.Time) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetCollectedAt(*v)
	}
	return _u
}

// SetFirstCollectedAt sets the "first_collected_at" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetFirstCollectedAt(v time.Time) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetFirstCollectedAt(v)
	return _u
}

// SetNillableFirstCollectedAt sets the "first_collected_at" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableFirstCollectedAt(v *time.Time) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetFirstCollectedAt(*v)
	}
	return _u
}

// SetResourceID sets the "resource_id" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetResourceID(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetResourceID(v)
	return _u
}

// SetNillableResourceID sets the "resource_id" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableResourceID(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetResourceID(*v)
	}
	return _u
}

// SetAgentID sets the "agent_id" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAgentID(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAgentID(v)
	return _u
}

// SetNillableAgentID sets the "agent_id" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAgentID(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentID(*v)
	}
	return _u
}

// ClearAgentID clears the value of the "agent_id" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearAgentID() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearAgentID()
	return _u
}

// SetClassification sets the "classification" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetClassification(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetClassification(v)
	return _u
}

// SetNillableClassification sets the "classification" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableClassification(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetClassification(*v)
	}
	return _u
}

// ClearClassification clears the value of the "classification" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearClassification() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearClassification()
	return _u
}

// SetThreatName sets the "threat_name" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetThreatName(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetThreatName(v)
	return _u
}

// SetNillableThreatName sets the "threat_name" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableThreatName(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetThreatName(*v)
	}
	return _u
}

// ClearThreatName clears the value of the "threat_name" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearThreatName() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearThreatName()
	return _u
}

// SetFilePath sets the "file_path" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetFilePath(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetFilePath(v)
	return _u
}

// SetNillableFilePath sets the "file_path" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableFilePath(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetFilePath(*v)
	}
	return _u
}

// ClearFilePath clears the value of the "file_path" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearFilePath() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearFilePath()
	return _u
}

// SetStatus sets the "status" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetStatus(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetStatus(v)
	return _u
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableStatus(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetStatus(*v)
	}
	return _u
}

// ClearStatus clears the value of the "status" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearStatus() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearStatus()
	return _u
}

// SetAnalystVerdict sets the "analyst_verdict" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAnalystVerdict(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAnalystVerdict(v)
	return _u
}

// SetNillableAnalystVerdict sets the "analyst_verdict" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAnalystVerdict(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAnalystVerdict(*v)
	}
	return _u
}

// ClearAnalystVerdict clears the value of the "analyst_verdict" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearAnalystVerdict() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearAnalystVerdict()
	return _u
}

// SetConfidenceLevel sets the "confidence_level" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetConfidenceLevel(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetConfidenceLevel(v)
	return _u
}

// SetNillableConfidenceLevel sets the "confidence_level" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableConfidenceLevel(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetConfidenceLevel(*v)
	}
	return _u
}

// ClearConfidenceLevel clears the value of the "confidence_level" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearConfidenceLevel() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearConfidenceLevel()
	return _u
}

// SetInitiatedBy sets the "initiated_by" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetInitiatedBy(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetInitiatedBy(v)
	return _u
}

// SetNillableInitiatedBy sets the "initiated_by" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableInitiatedBy(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetInitiatedBy(*v)
	}
	return _u
}

// ClearInitiatedBy clears the value of the "initiated_by" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearInitiatedBy() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearInitiatedBy()
	return _u
}

// SetAPICreatedAt sets the "api_created_at" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAPICreatedAt(v time.Time) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAPICreatedAt(v)
	return _u
}

// SetNillableAPICreatedAt sets the "api_created_at" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAPICreatedAt(v *time.Time) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAPICreatedAt(*v)
	}
	return _u
}

// ClearAPICreatedAt clears the value of the "api_created_at" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearAPICreatedAt() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearAPICreatedAt()
	return _u
}

// SetThreatInfoJSON sets the "threat_info_json" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetThreatInfoJSON(v json.RawMessage) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetThreatInfoJSON(v)
	return _u
}

// AppendThreatInfoJSON appends value to the "threat_info_json" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) AppendThreatInfoJSON(v json.RawMessage) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.AppendThreatInfoJSON(v)
	return _u
}

// ClearThreatInfoJSON clears the value of the "threat_info_json" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearThreatInfoJSON() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearThreatInfoJSON()
	return _u
}

// SetAPIUpdatedAt sets the "api_updated_at" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAPIUpdatedAt(v time.Time) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAPIUpdatedAt(v)
	return _u
}

// SetNillableAPIUpdatedAt sets the "api_updated_at" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAPIUpdatedAt(v *time.Time) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAPIUpdatedAt(*v)
	}
	return _u
}

// ClearAPIUpdatedAt clears the value of the "api_updated_at" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearAPIUpdatedAt() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearAPIUpdatedAt()
	return _u
}

// SetFileContentHash sets the "file_content_hash" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetFileContentHash(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetFileContentHash(v)
	return _u
}

// SetNillableFileContentHash sets the "file_content_hash" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableFileContentHash(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetFileContentHash(*v)
	}
	return _u
}

// ClearFileContentHash clears the value of the "file_content_hash" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearFileContentHash() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearFileContentHash()
	return _u
}

// SetFileSha256 sets the "file_sha256" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetFileSha256(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetFileSha256(v)
	return _u
}

// SetNillableFileSha256 sets the "file_sha256" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableFileSha256(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetFileSha256(*v)
	}
	return _u
}

// ClearFileSha256 clears the value of the "file_sha256" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearFileSha256() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearFileSha256()
	return _u
}

// SetCloudVerdict sets the "cloud_verdict" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetCloudVerdict(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetCloudVerdict(v)
	return _u
}

// SetNillableCloudVerdict sets the "cloud_verdict" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableCloudVerdict(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetCloudVerdict(*v)
	}
	return _u
}

// ClearCloudVerdict clears the value of the "cloud_verdict" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearCloudVerdict() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearCloudVerdict()
	return _u
}

// SetClassificationSource sets the "classification_source" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetClassificationSource(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetClassificationSource(v)
	return _u
}

// SetNillableClassificationSource sets the "classification_source" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableClassificationSource(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetClassificationSource(*v)
	}
	return _u
}

// ClearClassificationSource clears the value of the "classification_source" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearClassificationSource() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearClassificationSource()
	return _u
}

// SetSiteID sets the "site_id" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetSiteID(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetSiteID(v)
	return _u
}

// SetNillableSiteID sets the "site_id" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableSiteID(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetSiteID(*v)
	}
	return _u
}

// ClearSiteID clears the value of the "site_id" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearSiteID() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearSiteID()
	return _u
}

// SetSiteName sets the "site_name" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetSiteName(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetSiteName(v)
	return _u
}

// SetNillableSiteName sets the "site_name" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableSiteName(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetSiteName(*v)
	}
	return _u
}

// ClearSiteName clears the value of the "site_name" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearSiteName() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearSiteName()
	return _u
}

// SetAccountID sets the "account_id" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAccountID(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAccountID(v)
	return _u
}

// SetNillableAccountID sets the "account_id" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAccountID(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAccountID(*v)
	}
	return _u
}

// ClearAccountID clears the value of the "account_id" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearAccountID() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearAccountID()
	return _u
}

// SetAccountName sets the "account_name" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAccountName(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAccountName(v)
	return _u
}

// SetNillableAccountName sets the "account_name" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAccountName(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAccountName(*v)
	}
	return _u
}

// ClearAccountName clears the value of the "account_name" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearAccountName() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearAccountName()
	return _u
}

// SetAgentComputerName sets the "agent_computer_name" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAgentComputerName(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAgentComputerName(v)
	return _u
}

// SetNillableAgentComputerName sets the "agent_computer_name" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAgentComputerName(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentComputerName(*v)
	}
	return _u
}

// ClearAgentComputerName clears the value of the "agent_computer_name" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearAgentComputerName() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearAgentComputerName()
	return _u
}

// SetAgentOsType sets the "agent_os_type" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAgentOsType(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAgentOsType(v)
	return _u
}

// SetNillableAgentOsType sets the "agent_os_type" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAgentOsType(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentOsType(*v)
	}
	return _u
}

// ClearAgentOsType clears the value of the "agent_os_type" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearAgentOsType() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearAgentOsType()
	return _u
}

// SetAgentMachineType sets the "agent_machine_type" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAgentMachineType(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAgentMachineType(v)
	return _u
}

// SetNillableAgentMachineType sets the "agent_machine_type" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAgentMachineType(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentMachineType(*v)
	}
	return _u
}

// ClearAgentMachineType clears the value of the "agent_machine_type" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearAgentMachineType() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearAgentMachineType()
	return _u
}

// SetAgentIsActive sets the "agent_is_active" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAgentIsActive(v bool) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAgentIsActive(v)
	return _u
}

// SetNillableAgentIsActive sets the "agent_is_active" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAgentIsActive(v *bool) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentIsActive(*v)
	}
	return _u
}

// SetAgentIsDecommissioned sets the "agent_is_decommissioned" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAgentIsDecommissioned(v bool) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAgentIsDecommissioned(v)
	return _u
}

// SetNillableAgentIsDecommissioned sets the "agent_is_decommissioned" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAgentIsDecommissioned(v *bool) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentIsDecommissioned(*v)
	}
	return _u
}

// SetAgentVersion sets the "agent_version" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetAgentVersion(v string) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.SetAgentVersion(v)
	return _u
}

// SetNillableAgentVersion sets the "agent_version" field if the given value is not nil.
func (_u *BronzeHistoryS1ThreatUpdateOne) SetNillableAgentVersion(v *string) *BronzeHistoryS1ThreatUpdateOne {
	if v != nil {
		_u.SetAgentVersion(*v)
	}
	return _u
}

// ClearAgentVersion clears the value of the "agent_version" field.
func (_u *BronzeHistoryS1ThreatUpdateOne) ClearAgentVersion() *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.ClearAgentVersion()
	return _u
}

// Mutation returns the BronzeHistoryS1ThreatMutation object of the builder.
func (_u *BronzeHistoryS1ThreatUpdateOne) Mutation() *BronzeHistoryS1ThreatMutation {
	return _u.mutation
}

// Where appends a list predicates to the BronzeHistoryS1ThreatUpdate builder.
func (_u *BronzeHistoryS1ThreatUpdateOne) Where(ps ...predicate.BronzeHistoryS1Threat) *BronzeHistoryS1ThreatUpdateOne {
	_u.mutation.Where(ps...)
	return _u
}

// Select allows selecting one or more fields (columns) of the returned entity.
// The default is selecting all fields defined in the entity schema.
func (_u *BronzeHistoryS1ThreatUpdateOne) Select(field string, fields ...string) *BronzeHistoryS1ThreatUpdateOne {
	_u.fields = append([]string{field}, fields...)
	return _u
}

// Save executes the query and returns the updated BronzeHistoryS1Threat entity.
func (_u *BronzeHistoryS1ThreatUpdateOne) Save(ctx context.Context) (*BronzeHistoryS1Threat, error) {
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *BronzeHistoryS1ThreatUpdateOne) SaveX(ctx context.Context) *BronzeHistoryS1Threat {
	node, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return node
}

// Exec executes the query on the entity.
func (_u *BronzeHistoryS1ThreatUpdateOne) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *BronzeHistoryS1ThreatUpdateOne) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

// check runs all checks and user-defined validators on the builder.
func (_u *BronzeHistoryS1ThreatUpdateOne) check() error {
	if v, ok := _u.mutation.ResourceID(); ok {
		if err := bronzehistorys1threat.ResourceIDValidator(v); err != nil {
			return &ValidationError{Name: "resource_id", err: fmt.Errorf(`ent: validator failed for field "BronzeHistoryS1Threat.resource_id": %w`, err)}
		}
	}
	return nil
}

func (_u *BronzeHistoryS1ThreatUpdateOne) sqlSave(ctx context.Context) (_node *BronzeHistoryS1Threat, err error) {
	if err := _u.check(); err != nil {
		return _node, err
	}
	_spec := sqlgraph.NewUpdateSpec(bronzehistorys1threat.Table, bronzehistorys1threat.Columns, sqlgraph.NewFieldSpec(bronzehistorys1threat.FieldID, field.TypeInt))
	id, ok := _u.mutation.ID()
	if !ok {
		return nil, &ValidationError{Name: "id", err: errors.New(`ent: missing "BronzeHistoryS1Threat.id" for update`)}
	}
	_spec.Node.ID.Value = id
	if fields := _u.fields; len(fields) > 0 {
		_spec.Node.Columns = make([]string, 0, len(fields))
		_spec.Node.Columns = append(_spec.Node.Columns, bronzehistorys1threat.FieldID)
		for _, f := range fields {
			if !bronzehistorys1threat.ValidColumn(f) {
				return nil, &ValidationError{Name: f, err: fmt.Errorf("ent: invalid field %q for query", f)}
			}
			if f != bronzehistorys1threat.FieldID {
				_spec.Node.Columns = append(_spec.Node.Columns, f)
			}
		}
	}
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := _u.mutation.ValidTo(); ok {
		_spec.SetField(bronzehistorys1threat.FieldValidTo, field.TypeTime, value)
	}
	if _u.mutation.ValidToCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldValidTo, field.TypeTime)
	}
	if value, ok := _u.mutation.CollectedAt(); ok {
		_spec.SetField(bronzehistorys1threat.FieldCollectedAt, field.TypeTime, value)
	}
	if value, ok := _u.mutation.FirstCollectedAt(); ok {
		_spec.SetField(bronzehistorys1threat.FieldFirstCollectedAt, field.TypeTime, value)
	}
	if value, ok := _u.mutation.ResourceID(); ok {
		_spec.SetField(bronzehistorys1threat.FieldResourceID, field.TypeString, value)
	}
	if value, ok := _u.mutation.AgentID(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentID, field.TypeString, value)
	}
	if _u.mutation.AgentIDCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAgentID, field.TypeString)
	}
	if value, ok := _u.mutation.Classification(); ok {
		_spec.SetField(bronzehistorys1threat.FieldClassification, field.TypeString, value)
	}
	if _u.mutation.ClassificationCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldClassification, field.TypeString)
	}
	if value, ok := _u.mutation.ThreatName(); ok {
		_spec.SetField(bronzehistorys1threat.FieldThreatName, field.TypeString, value)
	}
	if _u.mutation.ThreatNameCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldThreatName, field.TypeString)
	}
	if value, ok := _u.mutation.FilePath(); ok {
		_spec.SetField(bronzehistorys1threat.FieldFilePath, field.TypeString, value)
	}
	if _u.mutation.FilePathCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldFilePath, field.TypeString)
	}
	if value, ok := _u.mutation.Status(); ok {
		_spec.SetField(bronzehistorys1threat.FieldStatus, field.TypeString, value)
	}
	if _u.mutation.StatusCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldStatus, field.TypeString)
	}
	if value, ok := _u.mutation.AnalystVerdict(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAnalystVerdict, field.TypeString, value)
	}
	if _u.mutation.AnalystVerdictCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAnalystVerdict, field.TypeString)
	}
	if value, ok := _u.mutation.ConfidenceLevel(); ok {
		_spec.SetField(bronzehistorys1threat.FieldConfidenceLevel, field.TypeString, value)
	}
	if _u.mutation.ConfidenceLevelCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldConfidenceLevel, field.TypeString)
	}
	if value, ok := _u.mutation.InitiatedBy(); ok {
		_spec.SetField(bronzehistorys1threat.FieldInitiatedBy, field.TypeString, value)
	}
	if _u.mutation.InitiatedByCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldInitiatedBy, field.TypeString)
	}
	if value, ok := _u.mutation.APICreatedAt(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAPICreatedAt, field.TypeTime, value)
	}
	if _u.mutation.APICreatedAtCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAPICreatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.ThreatInfoJSON(); ok {
		_spec.SetField(bronzehistorys1threat.FieldThreatInfoJSON, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedThreatInfoJSON(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, bronzehistorys1threat.FieldThreatInfoJSON, value)
		})
	}
	if _u.mutation.ThreatInfoJSONCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldThreatInfoJSON, field.TypeJSON)
	}
	if value, ok := _u.mutation.APIUpdatedAt(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAPIUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.APIUpdatedAtCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAPIUpdatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.FileContentHash(); ok {
		_spec.SetField(bronzehistorys1threat.FieldFileContentHash, field.TypeString, value)
	}
	if _u.mutation.FileContentHashCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldFileContentHash, field.TypeString)
	}
	if value, ok := _u.mutation.FileSha256(); ok {
		_spec.SetField(bronzehistorys1threat.FieldFileSha256, field.TypeString, value)
	}
	if _u.mutation.FileSha256Cleared() {
		_spec.ClearField(bronzehistorys1threat.FieldFileSha256, field.TypeString)
	}
	if value, ok := _u.mutation.CloudVerdict(); ok {
		_spec.SetField(bronzehistorys1threat.FieldCloudVerdict, field.TypeString, value)
	}
	if _u.mutation.CloudVerdictCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldCloudVerdict, field.TypeString)
	}
	if value, ok := _u.mutation.ClassificationSource(); ok {
		_spec.SetField(bronzehistorys1threat.FieldClassificationSource, field.TypeString, value)
	}
	if _u.mutation.ClassificationSourceCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldClassificationSource, field.TypeString)
	}
	if value, ok := _u.mutation.SiteID(); ok {
		_spec.SetField(bronzehistorys1threat.FieldSiteID, field.TypeString, value)
	}
	if _u.mutation.SiteIDCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldSiteID, field.TypeString)
	}
	if value, ok := _u.mutation.SiteName(); ok {
		_spec.SetField(bronzehistorys1threat.FieldSiteName, field.TypeString, value)
	}
	if _u.mutation.SiteNameCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldSiteName, field.TypeString)
	}
	if value, ok := _u.mutation.AccountID(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAccountID, field.TypeString, value)
	}
	if _u.mutation.AccountIDCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAccountID, field.TypeString)
	}
	if value, ok := _u.mutation.AccountName(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAccountName, field.TypeString, value)
	}
	if _u.mutation.AccountNameCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAccountName, field.TypeString)
	}
	if value, ok := _u.mutation.AgentComputerName(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentComputerName, field.TypeString, value)
	}
	if _u.mutation.AgentComputerNameCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAgentComputerName, field.TypeString)
	}
	if value, ok := _u.mutation.AgentOsType(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentOsType, field.TypeString, value)
	}
	if _u.mutation.AgentOsTypeCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAgentOsType, field.TypeString)
	}
	if value, ok := _u.mutation.AgentMachineType(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentMachineType, field.TypeString, value)
	}
	if _u.mutation.AgentMachineTypeCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAgentMachineType, field.TypeString)
	}
	if value, ok := _u.mutation.AgentIsActive(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentIsActive, field.TypeBool, value)
	}
	if value, ok := _u.mutation.AgentIsDecommissioned(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentIsDecommissioned, field.TypeBool, value)
	}
	if value, ok := _u.mutation.AgentVersion(); ok {
		_spec.SetField(bronzehistorys1threat.FieldAgentVersion, field.TypeString, value)
	}
	if _u.mutation.AgentVersionCleared() {
		_spec.ClearField(bronzehistorys1threat.FieldAgentVersion, field.TypeString)
	}
	_spec.Node.Schema = _u.schemaConfig.BronzeHistoryS1Threat
	ctx = internal.NewSchemaConfigContext(ctx, _u.schemaConfig)
	_node = &BronzeHistoryS1Threat{config: _u.config}
	_spec.Assign = _node.assignValues
	_spec.ScanValues = _node.scanValues
	if err = sqlgraph.UpdateNode(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{bronzehistorys1threat.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return nil, err
	}
	_u.mutation.done = true
	return _node, nil
}
